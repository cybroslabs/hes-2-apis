// Editions version of proto3 file
edition = "2023";
package io.clbs.openhes.models.common;

option go_package = "github.com/cybroslabs/ouro-api-shared/gen/go/common";

import "common/fields.proto";
import "common/objects.proto";

// The request to set the managed fields of the resource.
message SetManagedFieldsRequest {
    ObjectType object_type                        = 1;  // The type of the managed fields update. It defines the resource type for which the managed fields are set.
    string id                                     = 2;  // The UUID of the resource. It serves as the unique identifier of the resource. It's immutable and typically auto-generated during Create operations.
    int32 generation                              = 3;  // The generation of the resource, optional. If set then it must match the current generation of the resource, otherwise the data are overwritten without checking the generation.
    map<string, common.FieldValue> managed_fields = 4;  // The additional fields managed by system.
}

message FieldDescriptorInternal {
    string id                        = 1;  // The system-wide unique identifier of the field descriptor.
    string group                     = 2;  // The group identifier of the field descriptors, either object type or driver type for example. The obsolete field descriptors are detected and removed based on this field.
    string db_path                   = 3;  // The database path of the field, used for JSONB columns.
    FieldDescriptor field_descriptor = 4;  // The field descriptor of the field, used for JSONB columns.
}

message UpdateFieldDescriptorsRequest {
    string component_type                  = 1;  // The type of the component for which the field descriptors are updated, e.g., "device", "bulk", etc.
    repeated FieldDescriptorInternal items = 2;  // The list of field descriptors.
    bool cleanup_missing                   = 3;  // If true, it will remove all field descriptors that are not present in the request for given component type.
}

message ListOfFieldDescriptorInternal {
    repeated FieldDescriptorInternal items = 1;  // The list of field descriptors.
}
